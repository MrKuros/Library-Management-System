{% extends "base.html" %}

{% block title %}Books - Library Management System{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6">Books</h1>
<button onclick="openModal('addBookModal')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded mb-4">
    Add New Book
</button>
<div class="overflow-x-auto">
    <table class="min-w-full bg-white">
        <thead class="bg-gray-100">
            <tr>
                <th class="py-2 px-4 border-b">Title</th>
                <th class="py-2 px-4 border-b">Authors</th>
                <th class="py-2 px-4 border-b">Rating</th>
                <th class="py-2 px-4 border-b">Stock</th>
                <th class="py-2 px-4 border-b">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for book in books %}
            <tr>
                <td class="py-2 px-4 border-b">{{ book.title }}</td>
                <td class="py-2 px-4 border-b">{{ book.authors }}</td>
                <td class="py-2 px-4 border-b">{{ book.rating }}</td>
                <td class="py-2 px-4 border-b">{{ book.stock }}</td>
                <td class="py-2 px-4 border-b">
                    <a href="{{ url_for('edit_book', id=book.id) }}" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-2 rounded text-sm">Edit</a>
                    <a href="{{ url_for('delete_book', id=book.id) }}" class="bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-2 rounded text-sm" onclick="return confirm('Are you sure you want to delete this book?')">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Add Book Modal -->
<div id="addBookModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <h3 class="text-lg leading-6 font-medium text-gray-900">Add New Book</h3>
            <div class="mt-2 px-7 py-3">
                <form action="{{ url_for('add_book') }}" method="POST">
                    <input type="text" name="title" placeholder="Title" class="mb-3 px-3 py-2 border rounded-lg w-full" required>
                    <input type="text" name="author" placeholder="Author" class="mb-3 px-3 py-2 border rounded-lg w-full" required>
                    <input type="number" name="rating" placeholder="Rating" step="0.1" min="0" max="5" class="mb-3 px-3 py-2 border rounded-lg w-full" required>
                    <input type="number" name="stock" placeholder="Stock" class="mb-3 px-3 py-2 border rounded-lg w-full" required>
                    <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">Add Book</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function openModal(modalId) {
        document.getElementById(modalId).classList.remove('hidden');
    }

    window.onclick = function(event) {
        if (event.target.id === 'addBookModal') {
            event.target.classList.add('hidden');
        }
    }
</script>
{% endblock %}
